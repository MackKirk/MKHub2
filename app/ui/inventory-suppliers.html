<!doctype html>
<meta charset="utf-8">
<title>Suppliers</title>
<link rel="stylesheet" href="/ui/styles.css">
<script src="/ui/app.js"></script>
<div id="sidebar"></div>
<div class="main">
  <h2>Suppliers</h2>
  <div class="row">
    <div class="field" style="max-width:320px"><label>Search</label><input id="q" placeholder="name or legal name" /></div>
    <div class="field" style="align-self:end"><button id="btnSearch">Search</button></div>
    <div class="field" style="align-self:end"><a class="btn" href="/ui/inventory-suppliers-new.html">+ New Supplier</a></div>
  </div>
  <div id="list" class="card"></div>
</div>
<script>
MKHubUI.initSidebar('inventory-suppliers');
async function load(){
  const token = MKHubUI.getTokenOrRedirect();
  const q = document.getElementById('q').value;
  const url = q ? ('/inventory/suppliers?q='+encodeURIComponent(q)) : '/inventory/suppliers';
  const r = await fetch(url, { headers:{ Authorization:'Bearer '+token }});
  const list = document.getElementById('list');
  if (!r.ok){ list.textContent='Not authorized or error.'; return; }
  const arr = await r.json();
  if (!arr.length){ list.textContent='No suppliers found.'; return; }
  list.innerHTML = arr.map(s=>`<div style="display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #eee">`
    + `<div><strong>${s.name}</strong>${s.legal_name?`<div class=muted>${s.legal_name}</div>`:''}`
    + `${s.city||s.province||s.country?`<div class=muted>${[s.city,s.province,s.country].filter(Boolean).join(', ')}</div>`:''}</div>`
    + `<div><a href="/ui/inventory-suppliers-detail.html?id=${s.id}">Open</a></div>`
  + `</div>`).join('');
}
document.getElementById('btnSearch').addEventListener('click', load);
load();
</script>


